# Variables {{{

# Conditionals:
DARWIN="uname | grep -q Darwin"
LINUX="uname | grep -q Linux"

# Badwolf:
BG="#1c1b1a"
FG="#f8f6f2"
GRAY="#353331"
# Gruvbox:
# BG="#282828"
# FG="#EBDBB2"
# GRAY="#504945"
ACTIVE="#[fg=$BG,bg=$FG]"
INACTIVE="#[fg=$FG,bg=$BG]"

# }}}

# Settings  {{{

# Helps with TrueColor support
set -g -a terminal-overrides ',*:Ss=\E[%p1%d q:Se=\E[2 q'
set -g default-terminal "xterm-256color"
set-option -ga terminal-overrides ",xterm-256color:Tc"

# inactive/active window style
# set -g window-active-style 'fg=colour007,bg=colour008'
# set -g window-style 'fg=colour007,bg=colour000'

set -g base-index 1         # start window indices at 1
setw -g pane-base-index 1   # start pane indices at 1

set -g renumber-windows on  # renumber windows on close
setw -g automatic-rename on # name window according to current program

set -g set-titles on # set terminal title

# Enable vi mode:
set -g status-keys vi
set -g mode-keys vi

# Remember 10000 lines of history:
set -g history-limit 10000

# Enable mouse mode:
set -g mouse on

# Don't wait for escape sequences:
set -sg escape-time 0

#  }}}

# Host Specific Settings  {{{

# Fix clipboard for macOS:
if-shell $DARWIN "set -g default-command 'reattach-to-user-namespace $SHELL --login'"

#  }}}

# Binds {{{

# Remap prefix key:
unbind C-b
set-option -g prefix C-a
bind C-a send-prefix

# Make tmux behave more like vim:
unbind %
bind v split-window -h -c '#{pane_current_path}'
unbind '"'
bind s split-window -v -c '#{pane_current_path}'

bind b list-buffers
bind p paste-buffer
bind P choose-buffer

# bind -n C-h run "(tmux display-message -p '#{pane_current_command}' | grep -iq vim && tmux send-keys C-h) || tmux select-pane -L"
# bind -n C-j run "(tmux display-message -p '#{pane_current_command}' | grep -iq vim && tmux send-keys C-j) || tmux select-pane -D"
# bind -n C-k run "(tmux display-message -p '#{pane_current_command}' | grep -iq vim && tmux send-keys C-k) || tmux select-pane -U"
# bind -n C-l run "(tmux display-message -p '#{pane_current_command}' | grep -iq vim && tmux send-keys C-l) || tmux select-pane -R"

bind C-l send-keys 'C-l'

bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

bind-key J resize-pane -D 5
bind-key K resize-pane -U 5
bind-key H resize-pane -L 5
bind-key L resize-pane -R 5

bind-key M-j resize-pane -D
bind-key M-k resize-pane -U
bind-key M-h resize-pane -L
bind-key M-l resize-pane -R

bind [ previous-window
bind ] next-window

bind o copy-mode

bind q kill-window
bind x kill-pane

# Other binds:
bind r source-file ~/.tmux.conf \; display "Reloaded"

bind f command-prompt -p find-session 'switch-client -t %%'

#  }}}

# Status Line {{{

# Statusline settings:
set -g status on               # display status line
set -g status-left-length 100  #
set -g status-right-length 100 #
set -g status-justify "left"   #
set -g status-interval 0       # never redraw status line if it's not changed


# Statusline design:
set -g status-bg $BG
setw -g window-status-separator ""
setw -g window-status-format "$INACTIVE #I #W "
setw -g window-status-current-format "$ACTIVE #I #W "
set -g status-left ""
if-shell $DARWIN "set -g status-right '$ACTIVE#(battery.sh)'"
if-shell $LINUX "set -g status-right ''"

# }}}

# vim: foldmethod=marker foldlevel=0 foldenable
